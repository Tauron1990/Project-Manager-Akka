@using ServiceManager.Shared.ServiceDeamon
@using Shared.BaseComponents

@page "/AppConfiguration"

@inherits PropertyChangedComponent

@inject IDatabaseConfig _databaseConfig

<Title Value="App Konfiguration"></Title>

<OperationHost>
    @if (_databaseConfig.IsReady)
    {
        <ServerConfigurationView/>
    }
    <MudTabs Elevation="2" Rounded="true" ApplyEffectsToContainer="true" PanelClass="pa-6" @bind-ActivePanelIndex="_currentPanel">
        <MudTabPanel Text="Datenbank">
            <ConfigurationViewDatabase/>
        </MudTabPanel>
        <MudTabPanel Text="Global">
            <DatabaseRequiredComponent>
                <DatabaseContent>
                    <ConfigurationViewGlobalConfig/>
                </DatabaseContent>
            </DatabaseRequiredComponent>
        </MudTabPanel>
        <MudTabPanel Text="Apps">
            <DatabaseRequiredComponent>
                <DatabaseContent>
                    <ConfigurationViewAppConfig/>
                </DatabaseContent>
            </DatabaseRequiredComponent>
        </MudTabPanel>
    </MudTabs>
</OperationHost>

@code {
    private int _currentPanel = 0;

    protected override async Task OnInitializedAsync()
    {
        await Track(_databaseConfig);
        await base.OnInitializedAsync();
    }

}
