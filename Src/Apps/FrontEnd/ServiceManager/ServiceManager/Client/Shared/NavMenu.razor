@using ServiceManager.Shared.ServiceDeamon
@inherits ComputedStateComponent<bool>

@inject IDatabaseConfig _database;
@inject NavigationManager _navigationManager;

<MudDivider Class="mb-4"></MudDivider>
<MudNavMenu>
    <MudNavLink Class="ma-1" OnClick="@(() => Callback(""))">Übersicht</MudNavLink>
    <MudBadge Icon="@(State.ValueOrDefault ? null : Icons.Material.Outlined.Warning)" Overlap="true" Class="ma-1">
        <MudNavLink OnClick="@(() => Callback("/AppConfiguration"))">Konfiguration</MudNavLink>
    </MudBadge>
</MudNavMenu>

@code {

    [Parameter]
    public EventCallback Navigating { get; set; }

    protected override Task<bool> ComputeState(CancellationToken cancellationToken) => _database.GetIsReady();

    private async Task Callback(string target)
    {
        await Navigating.InvokeAsync();
        _navigationManager.NavigateTo(target);
    }

}
